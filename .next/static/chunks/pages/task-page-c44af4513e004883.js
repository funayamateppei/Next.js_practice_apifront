(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55],{1401:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/task-page",function(){return __webpack_require__(548)}])},548:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__N_SSG:function(){return __N_SSG},default:function(){return task_page}});var jsx_runtime=__webpack_require__(5893),AppLayout=__webpack_require__(3400),head=__webpack_require__(9008),head_default=__webpack_require__.n(head),next_link=__webpack_require__(1664),link_default=__webpack_require__.n(next_link),axios=__webpack_require__(5814),react=__webpack_require__(7294);let StateContext=(0,react.createContext)();function StateContextProvider(props){let[selectedTask,setSelectedTask]=(0,react.useState)({id:0,title:""});return(0,jsx_runtime.jsx)(StateContext.Provider,{value:{selectedTask,setSelectedTask},children:props.children})}function Task(param){let{task,taskDeleted}=param,{setSelectedTask}=(0,react.useContext)(StateContext),deleteTask=async()=>{await axios.Z.delete("/api/tasks/".concat(task.id)).then(response=>{401===response.status&&alert("ログインしなおしてください"),taskDeleted()})};return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("span",{children:[task.id," : "]}),(0,jsx_runtime.jsx)(link_default(),{href:"/tasks/".concat(task.id),children:(0,jsx_runtime.jsx)("span",{className:"cursor-pointer border-b border-gray-400 hover:bg-gray-600",children:task.title})}),(0,jsx_runtime.jsxs)("div",{className:"float-right ml-20 mr-1 flex cursor-pointer",children:[(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",onClick:()=>setSelectedTask(task),children:(0,jsx_runtime.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",onClick:deleteTask,children:(0,jsx_runtime.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})]})]})}var dist=__webpack_require__(8100);function TaskForm(param){let{taskCreated}=param,{selectedTask,setSelectedTask}=(0,react.useContext)(StateContext),create=async e=>{e.preventDefault();let params={title:selectedTask.title};await axios.Z.post("/api/tasks",params).then(response=>{setSelectedTask({id:0,title:""}),taskCreated()})},update=async e=>{e.preventDefault();let params={title:selectedTask.title};axios.Z.put("/api/tasks/".concat(selectedTask.id),params).then(response=>{setSelectedTask({id:0,title:""}),taskCreated()})},cancel=e=>{e.preventDefault(),setSelectedTask({id:0,title:""}),taskCreated()};return(0,jsx_runtime.jsx)("div",{className:"mt-10",children:(0,jsx_runtime.jsxs)("form",{onSubmit:0!=selectedTask.id?update:create,children:[(0,jsx_runtime.jsx)("input",{className:"px-2 mb-8 py-1",type:"text",value:selectedTask.title,onChange(e){setSelectedTask({...selectedTask,title:e.target.value})}}),(0,jsx_runtime.jsx)("button",{type:"submit",className:"bg-gray-500 ml-2 hover:bg-gray-600 px-2 py-2 text-sm rounded uppercase",children:0!=selectedTask.id?"update":"create"}),(0,jsx_runtime.jsx)("button",{className:"bg-gray-500 ml-2 hover:bg-gray-600 px-2 py-2 text-sm rounded uppercase ".concat(0!==selectedTask.id?"":"hidden"),onClick:cancel,children:"cancel"})]})})}let TaskPage=param=>{let{tasks}=param,fetcher=url=>(0,axios.Z)(url).then(response=>response.data),{data:swrTasks,mutate}=(0,dist.ZP)("".concat("http://localhost","/api/tasks"),fetcher,{fallbackData:tasks});return(0,react.useEffect)(()=>{mutate()},[]),(0,jsx_runtime.jsx)(StateContextProvider,{children:(0,jsx_runtime.jsxs)(AppLayout.Z,{header:(0,jsx_runtime.jsx)("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Task Page"}),children:[(0,jsx_runtime.jsx)(head_default(),{children:(0,jsx_runtime.jsx)("title",{children:"Task Page"})}),(0,jsx_runtime.jsxs)("div",{className:"flex justify-center items-center flex-col",children:[(0,jsx_runtime.jsx)(TaskForm,{taskCreated:mutate}),(0,jsx_runtime.jsx)("ul",{children:swrTasks&&swrTasks.map(task=>(0,jsx_runtime.jsx)(Task,{task:task,taskDeleted:mutate},task.id))})]})]})})};var __N_SSG=!0,task_page=TaskPage}},function(__webpack_require__){__webpack_require__.O(0,[814,145,961,400,774,888,179],function(){return __webpack_require__(__webpack_require__.s=1401)}),_N_E=__webpack_require__.O()}]);